(function(e){function t(t){for(var n,a,i=t[0],c=t[1],l=t[2],u=0,p=[];u<i.length;u++)a=i[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(p.length)p.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,a=1;a<r.length;a++){var i=r[a];0!==o[i]&&(n=!1)}n&&(s.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},a={app:0},o={app:0},s=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-2135bde9":"6282707d","chunk-776dc0f1":"1146fa5f"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.e=function(e){var t=[],r={"chunk-2135bde9":1,"chunk-776dc0f1":1};a[e]?t.push(a[e]):0!==a[e]&&r[e]&&t.push(a[e]=new Promise((function(t,r){for(var n="css/"+({}[e]||e)+"."+{"chunk-2135bde9":"48fa1c7c","chunk-776dc0f1":"c5359049"}[e]+".css",o=c.p+n,s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var l=s[i],u=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(u===n||u===o))return t()}var p=document.getElementsByTagName("style");for(i=0;i<p.length;i++){l=p[i],u=l.getAttribute("data-href");if(u===n||u===o)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var n=t&&t.target&&t.target.src||o,s=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=n,delete a[e],d.parentNode.removeChild(d),r(s)},d.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){a[e]=0})));var n=o[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,r){n=o[e]=[t,r]}));t.push(n[2]=s);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,c.nc&&u.setAttribute("nonce",c.nc),u.src=i(e);var p=new Error;l=function(t){u.onerror=u.onload=null,clearTimeout(d);var r=o[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+n+": "+a+")",p.name="ChunkLoadError",p.type=n,p.request=a,r[1](p)}o[e]=void 0}};var d=setTimeout((function(){l({type:"timeout",target:u})}),12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],u=l.push.bind(l);l.push=t,l=l.slice();for(var p=0;p<l.length;p++)t(l[p]);var d=u;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},2395:function(e,t,r){},"2c0a":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"default",(function(){return H}));r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},s=[],i=(r("7c55"),r("2877")),c={},l=Object(i["a"])(c,o,s,!1,null,null,null),u=l.exports,p=(r("b0c0"),r("d3b7"),r("96cf"),r("1da1")),d=r("8c4f"),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home"},[n("el-card",{staticClass:"home_card accout_header"},[n("h1",[n("img",{attrs:{src:r("8cc2"),alt:""}})]),n("span",{staticClass:"account_name"},[e._v("Account: "+e._s(e.userName))]),n("span",{staticClass:"account_name"},[e._v("ONT ID: "+e._s(e.ontId))]),n("el-button",{attrs:{type:"text"},on:{click:e.logOut}},[e._v("Sign out")])],1),n("el-card",{staticClass:"home_card"},[n("div",{staticClass:"file_wrap"},[n("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"180px"}},[n("el-form-item",{attrs:{label:"File encryption code",prop:"password"}},[n("el-input",{attrs:{autocomplete:"off",type:"password",placeholder:"Create an encryption code"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("el-form-item",{attrs:{label:"File"}},[n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"","on-change":e.handleChange,"on-remove":e.handleRemove,"file-list":e.fileList,"http-request":e.fileupload,limit:1,"before-upload":e.beforeAvatarUpload}},[n("el-button",{attrs:{size:"small",type:"primary"}},[e._v("Select")]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" Good news! You can upload files up to 2 MB at a time. ")])],1)],1)],1),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("Upload")])],1)]),n("el-card",{staticClass:"home_card"},[n("el-table",{staticStyle:{width:"100%"},attrs:{"empty-text":"No Data",data:e.tableData,border:""}},[n("el-table-column",{attrs:{prop:"fileName",label:"File Name",width:"220"}}),n("el-table-column",{attrs:{prop:"fileHash",label:"File Hash"}}),n("el-table-column",{attrs:{prop:"txHash",label:"Transation Hash",align:"center",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{staticClass:"s-color",attrs:{target:"_blank",href:e.domain+"/transaction/"+t.row.txHash}},[e._v(e._s(t.row.txHash.substr(0,8)+"..."+t.row.txHash.substr(56,8)))])]}}])}),n("el-table-column",{attrs:{prop:"createTime",align:"center",label:"Upload Date",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.$utils.default.HelperTools.getTransDate(t.row.createTime))+" ")]}}])}),n("el-table-column",{attrs:{label:"Action",align:"center",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return e.openDownload(t.row.fileHash)}}},[e._v("Download")])]}}])})],1)],1),n("el-card",[n("div",{staticStyle:{"text-align":"center","font-size":"14px"}},[e._v(" This is an online software demo powered by Ontology. ")])])],1)},h=[],m=r("2909"),g=r("bc3a"),b=r.n(g),v=r("5c96"),y=r.n(v),w=b.a.create({timeout:1e4});w.interceptors.request.use((function(e){return e.headers={"Content-Type":"multipart/form-data"},e}),(function(e){return console.log(e),Promise.reject(e)})),w.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){var t=e.response;return t?400===t.status&&Object(v["Message"])({message:t.data.desc,type:"error"}):Object(v["Message"])({message:e,type:"error"}),console.error("err"+e),Promise.reject(e)}));var C=r("cc5e"),T={data:function(){return{userName:"",ontId:"",fileList:[],localFile:{},form:{password:""},rules:{password:[{required:!0,message:"Please enter file encryption code",trigger:"blur"},{pattern:/^[\S]{6,12}$/,min:6,max:12,message:"6~12 characters in length and cannot be empty!",trigger:"change"}]},fileObject:null,tableData:[],domain:"http://explorer.ontfs.io"}},methods:{logOut:function(){sessionStorage.clear(),this.$router.push({path:"/login"})},test:function(){var e=this.$utils.default.Encrypt("testpwd");console.log(e);var t=this.$utils.default.Decrypt(e);console.log(t)},handleRemove:function(e,t){this.fileObject=null},handlePreview:function(e){console.log(e)},handleChange:function(e,t){console.log(e)},fileupload:function(e){this.fileObject=e.file},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("Only files within 2 MB are allowed"),t},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){return e?t.fileObject?void t.handlerUpload():t.$message.error("Please select a file!"):(console.log("error submit!!"),!1)}))},handlerUpload:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a,o,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new FormData,t.append("file",this.fileObject),t.append("ontId",this.ontId),t.append("password",this.$utils.default.Encrypt(this.form.password)),r=t,n=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),e.next=8,b.a.post("http://128.1.38.196:10665/api/v1/data/upload",r,{headers:{"Content-Type":"multipart/form-data"}});case 8:a=e.sent,o=a.data,s=o.desc,i=o.error,o.result,"SUCCESS"===s&&0===i?(n.close(),this.open(),this.resetForm("form"),this.$refs.upload.clearFiles(),this.fileObject=null,this.handlerGetFile()):(n.close(),this.$message({type:"error",message:"upload fail, please try again!"}));case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),open:function(){this.$alert("File uploaded successfully! It will be available for access in approximately 2 minutes.","Tips",{confirmButtonText:"Confirm",callback:function(e){}})},resetForm:function(e){this.$refs[e].resetFields()},handlerGetFile:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(){var t,r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(C["getFileList"])(this.ontId);case 3:t=e.sent,r=t.desc,n=t.error,a=t.result,"SUCCESS"===r&&0===n&&(this.tableData=Object(m["a"])(a)),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),this.tableData=[];case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}(),openDownload:function(e){var t=this;this.$prompt("Please enter file decryption code","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",inputPattern:/^[\S]{6,12}$/,inputType:"password",inputErrorMessage:"6~12 characters in length and cannot be empty!"}).then((function(r){var n=r.value;t.handlerDownloadFile(e,n)})).catch((function(){}))},handlerDownloadFile:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t,r){var n,a,o,s,i,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={fileHash:t,password:this.$utils.default.Encrypt(r)},a=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.2)"}),e.prev=2,e.next=5,Object(C["downloadFile"])(n);case 5:o=e.sent,s=o.error,i=o.desc,c=o.result,0===s&&"SUCCESS"===i?(a.close(),window.open(c,"_self")):(l="",l="no available fs nodes to download file: no node had commit pdp prove data"==i?"Uploading file to ONTFS Test Net right now. Please try again later!":"wrong password"==i?"Wrong decryption code. Please try again.":"Error. Please try again!",this.$message({type:"error",message:l}),a.close()),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](2),a.close();case 13:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(t,r){return e.apply(this,arguments)}return t}()},mounted:function(){this.userName=sessionStorage.getItem("userName"),this.ontId=sessionStorage.getItem("ontId"),this.handlerGetFile()}},k=T,S=(r("721c"),Object(i["a"])(k,f,h,!1,null,"35900b49",null)),x=S.exports;a["default"].use(d["a"]);var _=[{path:"/",name:"home",component:x},{path:"/login",name:"LoginWrap",component:function(){return r.e("chunk-2135bde9").then(r.bind(null,"a55b"))}},{path:"/register",name:"RegisterWrap",component:function(){return r.e("chunk-776dc0f1").then(r.bind(null,"73cf"))}}],O=new d["a"]({mode:"history",routes:_});O.beforeEach(function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t,r,n){var a,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("LoginWrap"!==t.name&&"RegisterWrap"!==t.name){e.next=2;break}return e.abrupt("return",n());case 2:if(a=sessionStorage.getItem("userName"),o=sessionStorage.getItem("ontId"),a&&o){e.next=10;break}return s="Please Sign in!",Object(v["Message"])({message:s,type:"error"}),e.abrupt("return",n({name:"LoginWrap"}));case 10:return e.abrupt("return",n());case 11:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}());var j=O,U=r("2f62");a["default"].use(U["a"]);var I=new U["a"].Store({state:{},mutations:{},actions:{},modules:{}}),D=(r("b059"),r("0fae"),r("e25e"),r("25f0"),r("3452")),P=D.enc.Utf8.parse("1992101219960210"),F=D.enc.Utf8.parse("1996021019921012");function E(e){var t=D.enc.Hex.parse(e),r=D.enc.Base64.stringify(t),n=D.AES.decrypt(r,P,{iv:F,mode:D.mode.CBC,padding:D.pad.Pkcs7}),a=n.toString(D.enc.Utf8);return a.toString()}function $(e){var t=D.enc.Utf8.parse(e),r=D.AES.encrypt(t,P,{iv:F,mode:D.mode.CBC,padding:D.pad.Pkcs7});return r.ciphertext.toString().toUpperCase()}var M={getDateTime:function(e){var t=new Date(1e3*e),r=new Date,n=(r-t)/1e3;return parseInt(n)},getShowDate:function(e){return e<=60?e+"s":60<e&&e<=3600?parseInt(e/60)+"m":3600<e&&e<=86400?parseInt(e/3600)+"h":e>86400?parseInt(e/86400)+"d":void 0},getTransDate:function(e){return e*=1e3,"zh"===window.localStorage.getItem("user_lang")?this.getPRCTime(e):this.getUTCTime(e)},getUTCTime:function(e){var t=new Date(e),r=t.getUTCFullYear(),n=t.getUTCMonth()+1<10?"0"+(t.getUTCMonth()+1):t.getUTCMonth()+1,a="";switch(n.toString()){case"01":a="Jan-";break;case"02":a="Feb-";break;case"03":a="Mar-";break;case"04":a="Apr-";break;case"05":a="May-";break;case"06":a="Jun-";break;case"07":a="Jul-";break;case"08":a="Aug-";break;case"09":a="Sep-";break;case"10":a="Oct-";break;case"11":a="Nov-";break;case"12":a="Dec-";break;default:break}var o=t.getUTCDate()<10?"0"+t.getUTCDate()+"-":t.getUTCDate()+"-",s=t.getUTCHours()<10?"0"+t.getUTCHours():t.getUTCHours(),i=t.getUTCMinutes()<10?"0"+t.getUTCMinutes():t.getUTCMinutes(),c=t.getUTCSeconds()<10?"0"+t.getUTCSeconds():t.getUTCSeconds();return a+o+r+" "+s+":"+i+":"+c+" UTC"},getPRCTime:function(e){var t=new Date(e),r=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var a=t.getDate();a=a<10?"0"+a:a;var o=t.getHours();o=o<10?"0"+o:o;var s=t.getMinutes(),i=t.getSeconds();return s=s<10?"0"+s:s,i=i<10?"0"+i:i,r+"-"+n+"-"+a+" "+o+":"+s+":"+i},getDayFunc:function(e){var t=parseInt(e);if(parseInt(e)>60){var r=parseInt(e)%60,n=parseInt(e/60);if(t=n+":"+r,n>60){n=parseInt(e/60)%60;var a=parseInt(parseInt(e/60)/60);if(t=a+":"+n+":"+r,a>24){a=parseInt(parseInt(e/60)/60)%24;var o=parseInt(parseInt(parseInt(e/60)/60)/24);t=o+"day"+a+":"+n+":"+r}}}return t}},H={Decrypt:E,Encrypt:$,HelperTools:M};a["default"].prototype.$http=C,a["default"].prototype.$utils=n,a["default"].config.productionTip=!1,a["default"].use(y.a),new a["default"]({router:j,store:I,render:function(e){return e(u)}}).$mount("#app")},"721c":function(e,t,r){"use strict";var n=r("2c0a"),a=r.n(n);a.a},"7c55":function(e,t,r){"use strict";var n=r("2395"),a=r.n(n);a.a},"8cc2":function(e,t,r){e.exports=r.p+"img/ontfsb.c550220c.svg"},b059:function(e,t,r){},cc5e:function(e,t,r){"use strict";r.r(t);r("99af"),r("d3b7");var n=r("bc3a"),a=r.n(n),o=r("5c96"),s=a.a.create({baseURL:"http://128.1.38.196:10665",timeout:3e4});s.interceptors.request.use((function(e){return e.data=JSON.stringify(e.data),e.headers={"Content-Type":"application/json"},e}),(function(e){return console.log(e),Promise.reject(e)})),s.interceptors.response.use((function(e){var t=e.data;return t}),(function(e){var t=e.response;return console.error("err"+e),t?400===t.status&&Object(o["Message"])({message:t.data.desc,type:"error"}):Object(o["Message"])({message:"Api Error, Please Try Again!",type:"error"}),Promise.reject(e)}));var i=s;function c(e){return i({url:"/api/v1/account/register",method:"post",data:e})}function l(e){return i({url:"/api/v1/account/login",method:"POST",data:e})}function u(e){return i({url:"/api/v1/data/".concat(e),method:"GET"})}function p(e){return i({url:"/api/v1/data/download-url?password=".concat(e.password,"&fileHash=").concat(e.fileHash),method:"GET"})}r.d(t,"Register",(function(){return c})),r.d(t,"Login",(function(){return l})),r.d(t,"getFileList",(function(){return u})),r.d(t,"downloadFile",(function(){return p}))}});
//# sourceMappingURL=app.c2684cf6.js.map